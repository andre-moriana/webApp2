<?php
// Modification temporaire du fichier groups/show.php pour debug
// Remplacer la section des boutons d action par ce code

// Dans le fichier groups/show.php, remplacez la section message-actions par :
?>

<div class="message-actions" style="opacity: 1 !important; background-color: rgba(255, 0, 0, 0.2) !important; border: 2px solid red !important; padding: 5px !important; display: block !important;">
    <?php 
    $currentUserId = $_SESSION["user"]["id"] ?? null;
    $messageUserId = $message["userId"] ?? $message["user_id"] ?? null;
    $isCurrentUserMessage = $currentUserId && $messageUserId && $currentUserId == $messageUserId;
    $isAdmin = $_SESSION["user"]["is_admin"] ?? $_SESSION["user"]["isAdmin"] ?? false;
    
    // Debug visible
    echo "<div class=\"debug-visible\" style=\"background-color: yellow; border: 2px solid orange; padding: 10px; margin: 5px 0;\">";
    echo "<strong>DEBUG:</strong><br>";
    echo "currentUserId: " . var_export($currentUserId, true) . "<br>";
    echo "messageUserId: " . var_export($messageUserId, true) . "<br>";
    echo "isCurrentUserMessage: " . var_export($isCurrentUserMessage, true) . "<br>";
    echo "isAdmin: " . var_export($isAdmin, true) . "<br>";
    echo "</div>";
    
    // FORCER L AFFICHAGE POUR DEBUG
    if (true): 
    ?>
        <div class="btn-group" role="group" style="display: block !important; visibility: visible !important;">
            <button type="button" class="btn btn-sm btn-outline-primary edit-message-btn" 
                    data-message-id="<?php echo htmlspecialchars($message["id"] ?? ""); ?>"
                    data-content="<?php echo htmlspecialchars($message["content"] ?? ""); ?>"
                    title="Modifier le message"
                    style="display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                <i class="fas fa-edit"></i> Modifier
            </button>
            <button type="button" class="btn btn-sm btn-outline-danger delete-message-btn" 
                    data-message-id="<?php echo htmlspecialchars($message["id"] ?? ""); ?>"
                    title="Supprimer le message"
                    style="display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                <i class="fas fa-trash"></i> Supprimer
            </button>
        </div>
    <?php endif; ?>
</div>

<?php
// Instructions pour appliquer cette modification :
// 1. Ouvrez le fichier WebApp2/app/Views/groups/show.php
// 2. Trouvez la section <div class="message-actions">
// 3. Remplacez tout le contenu entre <div class="message-actions"> et </div> par le code ci-dessus
// 4. Sauvegardez le fichier
// 5. Testez dans WAMP
?>
